<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Tic Tac Toe</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
    }

    .game-container {
        background: white;
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        max-width: 600px;
        width: 100%;
    }

    .header {
        text-align: center;
        margin-bottom: 30px;
    }

    .title {
        color: #333;
        font-size: 2.5em;
        font-weight: bold;
        margin-bottom: 10px;
        background: linear-gradient(45deg, #667eea, #764ba2);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .game-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 10px;
    }

    .current-player {
        font-size: 1.2em;
        font-weight: bold;
        color: #333;
    }

    .player-x { color: #e74c3c; }
    .player-o { color: #3498db; }

    .reset-btn {
        background: linear-gradient(45deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        transition: transform 0.2s;
    }

    .reset-btn:hover {
        transform: translateY(-2px);
    }

    .big-board {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-gap: 8px;
        background: #ddd;
        padding: 8px;
        border-radius: 12px;
        margin: 0 auto;
        max-width: 540px;
    }

    .small-board {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-gap: 2px;
        background: #bbb;
        padding: 2px;
        border-radius: 6px;
        position: relative;
        transition: all 0.3s ease;
    }

    .small-board.active {
        background: #ffeb3b;
        box-shadow: 0 0 20px rgba(255, 235, 59, 0.6);
        transform: scale(1.02);
    }

    .small-board.won {
        pointer-events: none;
    }

    .small-board.won::after {
        content: attr(data-winner);
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 4em;
        font-weight: bold;
        z-index: 10;
        animation: winPulse 0.6s ease-in-out;
    }

    .small-board.won.x::after {
        color: #e74c3c;
    }

    .small-board.won.o::after {
        color: #3498db;
    }

    .cell {
        width: 50px;
        height: 50px;
        background: white;
        border: none;
        cursor: pointer;
        font-size: 1.8em;
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        border-radius: 3px;
    }

    .cell:hover:not(:disabled) {
        background: #f0f0f0;
        transform: scale(1.05);
    }

    .cell:disabled {
        cursor: not-allowed;
        opacity: 0.7;
    }

    .cell.x {
        color: #e74c3c;
        animation: cellPop 0.3s ease-out;
    }

    .cell.o {
        color: #3498db;
        animation: cellPop 0.3s ease-out;
    }

    .winner-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.8);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1000;
    }

    .winner-content {
        background: white;
        padding: 40px;
        border-radius: 20px;
        text-align: center;
        animation: winnerSlide 0.5s ease-out;
    }

    .winner-text {
        font-size: 3em;
        font-weight: bold;
        margin-bottom: 20px;
    }

    .winner-text.x { color: #e74c3c; }
    .winner-text.o { color: #3498db; }
    .winner-text.tie { color: #95a5a6; }

    .play-again {
        background: linear-gradient(45deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 10px;
        cursor: pointer;
        font-size: 1.1em;
        font-weight: bold;
        transition: transform 0.2s;
    }

    .play-again:hover {
        transform: translateY(-2px);
    }

    .rules {
        margin-top: 20px;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 10px;
        font-size: 0.9em;
        color: #666;
        line-height: 1.4;
    }

    @keyframes cellPop {
        0% { transform: scale(0); }
        80% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }

    @keyframes winPulse {
        0% { transform: translate(-50%, -50%) scale(0); }
        50% { transform: translate(-50%, -50%) scale(1.2); }
        100% { transform: translate(-50%, -50%) scale(1); }
    }

    @keyframes winnerSlide {
        0% { transform: translateY(-100px); opacity: 0; }
        100% { transform: translateY(0); opacity: 1; }
    }

    @media (max-width: 600px) {
        .title { font-size: 2em; }
        .cell { width: 40px; height: 40px; font-size: 1.4em; }
        .small-board.won::after { font-size: 3em; }
        .game-container { padding: 20px; }
    }
</style>
```

</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1 class="title">Super Tic Tac Toe</h1>
        </div>

```
    <div class="game-info">
        <div class="current-player">
            Current Player: <span id="current-player-display" class="player-x">X</span>
        </div>
        <button class="reset-btn" onclick="resetGame()">New Game</button>
    </div>

    <div class="big-board" id="big-board">
        <!-- Small boards will be generated by JavaScript -->
    </div>

    <div class="rules">
        <strong>How to Play:</strong> Win small boards to claim them on the big board. 
        Your move determines which small board your opponent must play in next. 
        The highlighted board shows where you can play. Win 3 small boards in a row to win the game!
    </div>
</div>

<div class="winner-overlay" id="winner-overlay">
    <div class="winner-content">
        <div class="winner-text" id="winner-text"></div>
        <button class="play-again" onclick="resetGame()">Play Again</button>
    </div>
</div>

<script>
    class SuperTicTacToe {
        constructor() {
            this.currentPlayer = 'X';
            this.bigBoard = Array(9).fill(null).map(() => Array(9).fill(''));
            this.smallBoardWinners = Array(9).fill(null);
            this.activeBoard = null;
            this.gameOver = false;
            this.initializeBoard();
        }

        initializeBoard() {
            const bigBoardEl = document.getElementById('big-board');
            bigBoardEl.innerHTML = '';

            for (let boardIndex = 0; boardIndex < 9; boardIndex++) {
                const smallBoard = document.createElement('div');
                smallBoard.className = 'small-board';
                smallBoard.id = `board-${boardIndex}`;

                for (let cellIndex = 0; cellIndex < 9; cellIndex++) {
                    const cell = document.createElement('button');
                    cell.className = 'cell';
                    cell.id = `cell-${boardIndex}-${cellIndex}`;
                    cell.onclick = () => this.makeMove(boardIndex, cellIndex);
                    smallBoard.appendChild(cell);
                }

                bigBoardEl.appendChild(smallBoard);
            }

            this.updateDisplay();
        }

        makeMove(boardIndex, cellIndex) {
            if (this.gameOver || this.bigBoard[boardIndex][cellIndex] !== '' || 
                this.smallBoardWinners[boardIndex] !== null) {
                return;
            }

            if (this.activeBoard !== null && this.activeBoard !== boardIndex) {
                return;
            }

            // Make the move
            this.bigBoard[boardIndex][cellIndex] = this.currentPlayer;
            const cell = document.getElementById(`cell-${boardIndex}-${cellIndex}`);
            cell.textContent = this.currentPlayer;
            cell.className = `cell ${this.currentPlayer.toLowerCase()}`;
            cell.disabled = true;

            // Check if small board is won
            const smallBoardWinner = this.checkSmallBoardWin(boardIndex);
            if (smallBoardWinner) {
                this.smallBoardWinners[boardIndex] = smallBoardWinner;
                const smallBoardEl = document.getElementById(`board-${boardIndex}`);
                smallBoardEl.classList.add('won', smallBoardWinner.toLowerCase());
                smallBoardEl.setAttribute('data-winner', smallBoardWinner);
                
                // Disable all cells in won board
                for (let i = 0; i < 9; i++) {
                    const cellEl = document.getElementById(`cell-${boardIndex}-${i}`);
                    cellEl.disabled = true;
                }
            }

            // Check if game is won
            const gameWinner = this.checkGameWin();
            if (gameWinner) {
                this.gameOver = true;
                this.showWinner(gameWinner);
                return;
            }

            // Check for tie
            if (this.checkGameTie()) {
                this.gameOver = true;
                this.showWinner('TIE');
                return;
            }

            // Determine next active board
            if (this.smallBoardWinners[cellIndex] === null && 
                this.bigBoard[cellIndex].some(cell => cell === '')) {
                this.activeBoard = cellIndex;
            } else {
                this.activeBoard = null; // Can play anywhere
            }

            // Switch player
            this.currentPlayer = this.currentPlayer === 'X' ? 'O' : 'X';
            this.updateDisplay();
        }

        checkSmallBoardWin(boardIndex) {
            const board = this.bigBoard[boardIndex];
            const winPatterns = [
                [0,1,2], [3,4,5], [6,7,8], // rows
                [0,3,6], [1,4,7], [2,5,8], // columns
                [0,4,8], [2,4,6] // diagonals
            ];

            for (const pattern of winPatterns) {
                const [a, b, c] = pattern;
                if (board[a] && board[a] === board[b] && board[a] === board[c]) {
                    return board[a];
                }
            }
            return null;
        }

        checkGameWin() {
            const winPatterns = [
                [0,1,2], [3,4,5], [6,7,8], // rows
                [0,3,6], [1,4,7], [2,5,8], // columns
                [0,4,8], [2,4,6] // diagonals
            ];

            for (const pattern of winPatterns) {
                const [a, b, c] = pattern;
                if (this.smallBoardWinners[a] && 
                    this.smallBoardWinners[a] === this.smallBoardWinners[b] && 
                    this.smallBoardWinners[a] === this.smallBoardWinners[c]) {
                    return this.smallBoardWinners[a];
                }
            }
            return null;
        }

        checkGameTie() {
            return this.smallBoardWinners.every(winner => winner !== null);
        }

        updateDisplay() {
            // Update current player display
            const playerDisplay = document.getElementById('current-player-display');
            playerDisplay.textContent = this.currentPlayer;
            playerDisplay.className = `player-${this.currentPlayer.toLowerCase()}`;

            // Update active board highlighting
            for (let i = 0; i < 9; i++) {
                const boardEl = document.getElementById(`board-${i}`);
                boardEl.classList.remove('active');
                
                if (!this.gameOver && this.smallBoardWinners[i] === null) {
                    if (this.activeBoard === null || this.activeBoard === i) {
                        boardEl.classList.add('active');
                    }
                }
            }

            // Enable/disable cells based on game state
            if (!this.gameOver) {
                for (let boardIndex = 0; boardIndex < 9; boardIndex++) {
                    for (let cellIndex = 0; cellIndex < 9; cellIndex++) {
                        const cell = document.getElementById(`cell-${boardIndex}-${cellIndex}`);
                        const canPlay = this.bigBoard[boardIndex][cellIndex] === '' &&
                                      this.smallBoardWinners[boardIndex] === null &&
                                      (this.activeBoard === null || this.activeBoard === boardIndex);
                        cell.disabled = !canPlay;
                    }
                }
            }
        }

        showWinner(winner) {
            const overlay = document.getElementById('winner-overlay');
            const winnerText = document.getElementById('winner-text');
            
            if (winner === 'TIE') {
                winnerText.textContent = "It's a Tie!";
                winnerText.className = 'winner-text tie';
            } else {
                winnerText.textContent = `Player ${winner} Wins!`;
                winnerText.className = `winner-text ${winner.toLowerCase()}`;
            }
            
            overlay.style.display = 'flex';
        }

        reset() {
            this.currentPlayer = 'X';
            this.bigBoard = Array(9).fill(null).map(() => Array(9).fill(''));
            this.smallBoardWinners = Array(9).fill(null);
            this.activeBoard = null;
            this.gameOver = false;
            
            document.getElementById('winner-overlay').style.display = 'none';
            this.initializeBoard();
        }
    }

    let game;

    function initGame() {
        game = new SuperTicTacToe();
    }

    function resetGame() {
        game.reset();
    }

    // Initialize game when page loads
    window.onload = initGame;
</script>
```

</body>
</html>